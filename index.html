<!doctype html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>WebGL Craft</title>
    <script type="application/javascript" src="lib/webgl-utils.js"></script>
    <script type="application/javascript" src="lib/webgl-debug.js"></script>
    <script src="lib/J3DI.js"></script>
    <script src="lib/J3DIMath.js" type="application/javascript"></script>
    <script id="vshader" type="x-shader/x-vertex">

        uniform mat4 u_modelViewProjMatrix;
        uniform mat4 u_normalMatrix;
        uniform vec3 lightDir;

        attribute vec3 vNormal;
        attribute vec4 vTexCoord;
        attribute vec4 vPosition;

        varying float v_Dot;
        varying vec2 v_texCoord;

        void main() {
            gl_Position = u_modelViewProjMatrix * vPosition;
            v_texCoord = vTexCoord.st;
            vec4 transNormal = u_normalMatrix * vec4(vNormal, 1);
            v_Dot = max(dot(transNormal.xyz, lightDir), 0.0);
            // v_Dot = 1.0;
        }

    </script>
    <script id="fshader" type="x-shader/x-fragment">

        precision mediump float;

        uniform sampler2D sampler2d;

        varying float v_Dot;
        varying vec2 v_texCoord;

        void main()
        {
            vec2 texCoord = vec2(v_texCoord.s, 1.0 - v_texCoord.t);
            vec4 color = texture2D(sampler2d, texCoord);
            color += vec4(0.1, 0.1, 0.1, 1);
            gl_FragColor = vec4(color.xyz * v_Dot, color.a);
        }

    </script>
    <style>
        body, html {
            margin: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        body {
            background-color: #fed;
        }

        html {
            background-color: #bca;
        }

        #framerate {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: #345a;
            padding: 1em;
            color: white;
            border-radius: 1em;
            backdrop-filter: blur(10px);
            font-family: "JetBrains Mono",monospace;
            font-weight: bold;
            text-shadow: 2px 2px 1px #000;
            z-index: 2000;
        }

        #main {
            width: 100%;
            height: 100%;
        }

        #fatalError {
            border-radius: 40px;
            padding-left: 40px;
            padding-right: 40px;
            background-color: #a00d;
            color: #fff;
            text-align: left;
            align-content: center;
            box-sizing: border-box;
            height: calc(100% - 40px);
            margin: 20px;
            font-family: "JetBrains Mono",monospace;
            font-weight: bolder;
            font-size: 20px;
            backdrop-filter: blur(10px);
            text-shadow: 2px 2px 1px #000;

            > div {
                box-sizing: border-box;
                height: 100%;
                padding-top: 40px;
                padding-bottom: 40px;
                overflow: hidden;

                a {
                    text-decoration: none;
                    color: #0af;
                    text-shadow: 3px 3px 1px #00f;
                    display: inline-block;
                }

                a:hover {
                    background-color: #aaf;
                    border-radius: 5px;
                }
            }

            > div::selection {
                background-color: #0aa5;
                color: #aff;
                text-shadow: 0 0 10px #0ff;
                backdrop-filter: blur(10px);
            }
        }

        #fatalError:hover > div {
            overflow: scroll;
        }

        #dot > div {
            box-sizing: border-box;
            border-radius: 20px;
            width: 40px;
            height: 40px;
            margin: -20px;
            position: absolute;
            background-color: #fff;
            border: 5px solid black;
        }
    </style>
</head>
<body>
    <div id="dot"></div>
    <canvas id="main"></canvas>
    <div id="framerate">100fps<br>10ms</div>
    <script src="main.js" type="module"></script>
</body>
</html>